<div class="loading-container d-none">
  <h2 class="mb-4">Generating your itinerary...</h2>
  <div class="spinner-border text-primary m-3" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>
<%= render "sidebar", itinerary: @itinerary %>
<div class="generator-container">
  <div class="left-container">
    <!-- days -->
    <% if params[:day].present? %>
      <%= render 'itineraries/day', day: @day %>
    <% else %>
      <% @itinerary.days.count do |day| %>
        <%= render 'itineraries/day', day: day %>
      <% end %>
    <% end %>
    <!-- content -->
    <div class="content-cards-container">
      <% if  params[:day].present? %>
        <% @day.contents.each do |content| %>
          <%= render 'content', content: content %>
        <% end %>
      <% end %>
    </div>
  </div>
  <div class="right-container" data-controller="search">
    <!-- WORK IN PROGRESS -->
    <div class="card mb-3">
      <div class="card-body">
        <%= form_with url: itinerary_path(@itinerary), method: :get,
                      data: {
                        search_target: "form",
                        action: "submit->search#search"
                      } do %>
          <div class="d-flex search-container">
            <%= text_field_tag :query, params[:query], class: "form-control", placeholder: "search", data: {search_target: "query", action: "keyup->search#search"}%>
            <%= hidden_field_tag :day, params[:day], data: {search_target: "day"} %>
            <%= button_tag type:"search", class:"btn btn-primary btn-tabinow ms-2" do  %>
              <i class="fa-solid fa-magnifying-glass"></i>
            <% end %>
          </div>
          <div class="filters-container">
            <div class="filter-pill selected"
                 data-search-target="filterAccommodation"
                 data-action="click->search#filterAccommodations">
              Hotel
            </div>
            <div class="filter-pill selected"
                 data-search-target="filterActivity"
                 data-action="click->search#filterActivities">
              Activity
            </div>
            <div class="filter-pill selected"
                 data-search-target="filterRestaurant"
                 data-action="click->search#filterRestaurants">
              Restaurant
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <div class="results-container" data-search-target="results">
      <% if params[:query].present? %>
        <%= render 'results', contents: @contents, params: params %>
      <% end %>
    </div>
  </div>
</div>
